---
import { actions } from "astro:actions";

const {
  titulo,
  contenido,
  imagenUrl,
  invertir = false,
  modoEdicion = false,
  columna,
} = Astro.props;

const result = Astro.getActionResult(actions.updatePaginaPrincipal);
---

<section
  class="relative w-full bg-cover bg-center py-16 px-6 lg:px-24 text-white"
  style={`background-image: url('${imagenUrl}');`}
>
  <!-- Capa oscura encima de la imagen -->
  <div class="absolute inset-0 bg-black/50"></div>

  <!-- Contenido encima de la imagen -->
  <div
    class={`relative z-10 max-w-6xl mx-auto flex flex-col ${
      invertir ? "lg:flex-row-reverse" : "lg:flex-row"
    } items-center gap-12`}
  >
    <!-- Texto -->
    <div class="w-full text-center lg:text-left space-y-6">
      <form
        action={actions.updatePaginaPrincipal}
        method="post"
        enctype="multipart/form-data"
        class="flex flex-col gap-4 items-center lg:items-start"
      >
        {modoEdicion ? (
          <input
            type="text"
            name={`titulo-${columna}`}
            value={titulo}
            placeholder="Título"
            class="text-4xl lg:text-5xl font-extrabold bg-transparent w-full placeholder:text-gray-200 focus:outline-none border-b border-white pb-1 text-white drop-shadow-lg"
          />
        ) : (
          <h2 class="text-4xl lg:text-5xl font-extrabold drop-shadow-lg">{titulo}</h2>
        )}

        {modoEdicion ? (
          <>
            <textarea
              id={`contenido-${columna}`}
              name={columna}
              class="w-full bg-transparent p-2 text-lg focus:outline-none resize-none placeholder:text-gray-300 border-b border-white text-white drop-shadow"
              rows="6"
              required
              placeholder="Escribe contenido..."
            >{contenido}</textarea>

            <button
              type="submit"
              class="bg-[#7c0a0a] text-white text-sm px-6 py-2 rounded-full shadow-md hover:shadow-lg hover:brightness-110 transition-all duration-300"
            >
              Guardar texto
            </button>
          </>
        ) : (
          <p class="text-lg leading-relaxed whitespace-pre-line drop-shadow-lg">
            {contenido}
          </p>
        )}

        {result?.data?.success === false && (
          <p class="text-red-400 text-sm mt-1">{result?.data?.error}</p>
        )}
        {result?.data?.success === true && (
          <p class="text-green-300 text-sm mt-1">{result?.data?.message}</p>
        )}
      </form>
    </div>

    <!-- Edición imagen -->
    {modoEdicion && (
      <div class="w-full max-w-sm">
        <form
          action={actions.updatePaginaPrincipal}
          method="post"
          enctype="multipart/form-data"
          class="flex flex-col items-center gap-4"
        >
         <div class="group relative cursor-pointer text-sm text-white">
  <label for="imagen" class="cursor-pointer">
    Cambiar imagen de fondo
  </label>
  <span
    class="absolute left-0 -bottom-0.5 h-0.5 w-0 bg-white transition-all duration-300 group-hover:w-full"
  ></span>
</div>

          <input
            type="file"
            id="imagen"
            name="imagen"
            accept="image/*"
            class="hidden"
            required
          />

          <button
            type="submit"
            class="bg-[#7c0a0a] text-white text-sm px-4 py-2 rounded-full shadow hover:shadow-md hover:brightness-110 transition-all"
          >
            Guardar imagen
          </button>
        </form>
      </div>
    )}
  </div>
</section>
