---
import EventoCard from "./EventoCard.astro";
import { getEventosFiltrados } from "../actions/Eventos/getFiltros";
import type { Eventos } from "../interface/eventosSimple";

const { filtros = {} } = Astro.props;

const { data, error } = await Astro.callAction(getEventosFiltrados, filtros);

// ✅ Solución segura: forzar el tipo del array
const listaEventos = (data?.eventos || []) as Eventos[];
---

<div class="contenedor">
  {
    listaEventos.map((evento) => (
      <EventoCard
        imagen={evento.img_eve}
        titulo={evento.nom_eve}
        estado={evento.asignaciones?.length?.toString() || "0"}
        horas={evento.dur_eve ?? 0}
      />
    ))
  }
</div>

<style>
  .contenedor {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
  }
</style>

