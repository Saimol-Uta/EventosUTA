---
import InformacionUsuarioItem from './InformacionUsuarioItem.astro';

interface Campo {
  titulo: string;
  valor: string;
  name: string;
  pattern?: string;
  title?: string;
  oninput?: string;
  maxlength?: string;
}

interface Props {
  camposFormulario: Campo[];
  mostrarBotones?: boolean;
  textoBotonPrincipal?: string;
  textoBotonSecundario?: string;
}

const {
  camposFormulario,
  mostrarBotones = true,
  textoBotonPrincipal = "Guardar Información",
  textoBotonSecundario = "Más Tarde"
} = Astro.props as Props;

const usuarioExiste = camposFormulario.some(
  campo => campo.name !== 'contrasena' && campo.valor.trim() !== ''
);
---

<section class="formulario-container">
  <h2 class="formulario-titulo">Información del Usuario</h2>

  <form class="formulario-grid" method="POST">
    {camposFormulario.map((campo) => (
      <InformacionUsuarioItem
        titulo={campo.titulo}
        valor={campo.valor}
        name={campo.name}
        pattern={campo.pattern}
        title={campo.title}
        oninput={campo.oninput}
        maxlength={campo.maxlength}
      />
    ))}

    {mostrarBotones && (
      <div class="formulario-boton">
        {usuarioExiste ? (
          <>
            <button type="submit" name="action" value="guardar">{textoBotonPrincipal}</button>
            <button type="submit" name="reset" value="true">{textoBotonSecundario}</button>
          </>
        ) : (
          <>
            <button type="button">{textoBotonPrincipal}</button>
            <button type="submit">{textoBotonSecundario}</button>
          </>
        )}
      </div>
    )}
  </form>
</section>

<style>
.formulario-container {
  background-color: #eee;
  border-radius: 8px;
  padding: 2rem;
  max-width: 1000px;
  margin: 2rem auto;
  font-family: 'Segoe UI', sans-serif;
  box-shadow: 0 0 4px rgba(0,0,0,0.1);
}

.formulario-titulo {
  color: #8B0000;
  text-align: center;
  font-size: 24px;
  font-weight: bold;
  margin-bottom: 2rem;
}

.formulario-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.5rem;
}

.formulario-boton {
  grid-column: 1 / -1;
  text-align: center;
  margin-top: 1.5rem;
}

.formulario-boton button {
  background-color: #8B0000;
  color: white;
  font-size: 16px;
  padding: 10px 30px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  margin: 0 10px;
}

.formulario-boton button:hover {
  background-color: #a00;
}
</style>